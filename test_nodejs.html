<!DOCTYPE html>
<html>
<head>
    <title>Test Node.js in Wanix</title>
</head>
<body>
    <h1>Testing Node.js Support</h1>
    <pre id="output"></pre>
    
    <script src="wasm/assets/wasm_exec.js"></script>
    <script>
        const output = document.getElementById('output');
        
        function log(msg) {
            output.textContent += msg + '\n';
        }
        
        async function runTest() {
            try {
                log('Loading WASM...');
                const go = new Go();
                const result = await WebAssembly.instantiateStreaming(
                    fetch('wasm/assets/wanix.wasm'),
                    go.importObject
                );
                
                log('Starting Wanix...');
                go.run(result.instance);
                
                // Wait a bit for initialization
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                log('Creating test script...');
                // Simulate creating a hello world script
                const testScript = `console.log('Hello from Node.js in Wanix!');`;
                
                // Test the nodejs task directly
                log('Testing nodejs task...');
                
                // This would normally be done through the file system
                // For now, we'll test if the modules loaded correctly
                if (window.wanix) {
                    log('Wanix loaded successfully!');
                } else {
                    log('Wanix not found in window');
                }
                
            } catch (err) {
                log('Error: ' + err.message);
                console.error(err);
            }
        }
        
        runTest();
    </script>
</body>
</html>